<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mastering Apex Triggers: Patterns That Scale — Cloudforce</title>
  <meta name="description" content="Learn the handler pattern, one-trigger rule, bulkification, and how to test 200-record scenarios." />
  <link rel="icon" type="image/svg+xml" sizes="any" href="../favicon-cloudforce.svg" />
  <link rel="stylesheet" href="../css/style.css" />
</head>
<body>
<div class="reading-progress"></div>
<div class="search-overlay" role="dialog"><div class="search-box"><div class="search-input-wrap"><svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg><input class="search-input" type="search" placeholder="Search articles…" /><button class="search-close">✕</button></div><div class="search-suggestions"><h4>Popular topics</h4><div class="search-tags"><a href="category.html" class="tag tag-navy">Apex Triggers</a><a href="category.html" class="tag tag-blue">SOQL</a><a href="category.html" class="tag tag-sky">Flow Builder</a><a href="category.html" class="tag tag-orange">Governor Limits</a></div></div></div></div>
<header class="site-header">
  <div class="container"><div class="header-inner">
    <a href="../index.html" class="site-logo"><img src="../logo-cloudforce.svg" alt="Cloudforce" class="logo-image" /></a>
    <nav><ul class="site-nav"><li><a href="../index.html">Home</a></li><li class="nav-item"><a href="category.html" class="dropdown-toggle">Topics<svg viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="2" style="width:12px;height:12px"><path d="M2 4l4 4 4-4"/></svg></a><ul class="dropdown-menu"><li><a href="category.html">Salesforce Admin</a></li><li><a href="category.html">Apex &amp; LWC</a></li><li><a href="category.html">Flow &amp; Automation</a></li><li><a href="category.html">Integration</a></li><li><a href="category.html">DevOps &amp; CI/CD</a></li><li><a href="category.html">Agentforce &amp; AI</a></li><li><a href="category.html">Certifications</a></li></ul></li><li><a href="category.html">Tutorials</a></li><li><a href="category.html">Deep Dives</a></li><li><a href="about.html">About</a></li></ul></nav>
    <div class="header-search"><button class="search-btn" data-search-open><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg><span>Search</span></button><button class="hamburger" aria-expanded="false"><span></span><span></span><span></span></button></div>
  </div></div>
  <nav class="mobile-nav"><a href="../index.html">Home</a><details><summary>Topics</summary><div class="mobile-subnav"><a href="category.html">Salesforce Admin</a><a href="category.html">Apex &amp; LWC</a><a href="category.html">Flow &amp; Automation</a><a href="category.html">Integration</a><a href="category.html">DevOps &amp; CI/CD</a><a href="category.html">Agentforce &amp; AI</a><a href="category.html">Certifications</a></div></details><a href="category.html">Tutorials</a><a href="category.html">Deep Dives</a><a href="about.html">About</a></nav>
</header>

<div class="post-header">
  <div class="post-header-inner">
    <p class="post-category">
      <a href="category.html" class="tag tag-navy" style="font-size:0.72rem;">Apex</a>&nbsp;
      <a href="category.html" class="tag tag-blue" style="font-size:0.72rem;">Best Practices</a>
    </p>
    <h1>Mastering Apex Triggers: Patterns That Scale</h1>
    <p class="post-deck">Stop writing triggers that break at scale. Learn the handler pattern, the one-trigger rule, bulkification, and how to test 200-record scenarios your org will actually see in production.</p>
    <div class="post-byline">
      <div class="byline-avatar">ND</div>
      <div class="byline-info">
        <span class="byline-name">Nilesh Dethe</span>
        <div class="byline-meta"><span>Feb 18, 2026</span><span>·</span><span>12 min read</span><span>·</span><span>Salesforce PD II</span></div>
      </div>
    </div>
  </div>
</div>

<article>
  <div class="post-body">
    <div class="toc">
      <div class="toc-title">In this article</div>
      <ol>
        <li><a href="#why">Why Most Triggers Are Broken</a></li>
        <li><a href="#one-trigger">The One-Trigger-Per-Object Rule</a></li>
        <li><a href="#handler">The Handler Pattern</a></li>
        <li><a href="#bulkify">Bulkification in Practice</a></li>
        <li><a href="#testing">Testing for 200 Records</a></li>
        <li><a href="#checklist">Production-Ready Checklist</a></li>
      </ol>
    </div>

    <h2 id="why">Why Most Triggers Are Broken</h2>
    <p>In nearly every Salesforce org I've consulted on, I find the same pattern: triggers written quickly to solve an immediate problem, with no thought to what happens when a data loader processes 50,000 records. They work fine in testing. They fall apart in production.</p>
    <p>The core problem is that Apex triggers operate in batches of up to 200 records. Salesforce groups records to minimize server round-trips. If your trigger assumes it's always dealing with a single record — because a user only clicks Save once — you're setting a trap.</p>

    <div class="callout">
      <div class="callout-label">Key Concept</div>
      <p>Salesforce processes triggers in batches of up to 200 records. Any trigger that assumes <code>Trigger.new[0]</code> is the only record will fail under bulk operations, data migrations, or even a Flow firing on multiple records simultaneously.</p>
    </div>

    <h2 id="one-trigger">The One-Trigger-Per-Object Rule</h2>
    <p>The first thing to enforce: one trigger per object, period. Multiple triggers on the same object execute in an unpredictable order. There is no way to guarantee <code>TriggerA</code> runs before <code>TriggerB</code>. As soon as you have two triggers on Account, you've introduced a race condition you can't control.</p>
    <p>The single trigger acts as a dispatcher — routing execution to appropriate handler methods based on context:</p>

<pre><code>trigger AccountTrigger on Account (
  before insert, before update, before delete,
  after insert, after update, after delete, after undelete
) {
  AccountTriggerHandler handler = new AccountTriggerHandler();

  if (Trigger.isBefore) {
    if (Trigger.isInsert) handler.beforeInsert(Trigger.new);
    if (Trigger.isUpdate) handler.beforeUpdate(Trigger.new, Trigger.oldMap);
    if (Trigger.isDelete) handler.beforeDelete(Trigger.old);
  }
  if (Trigger.isAfter) {
    if (Trigger.isInsert)   handler.afterInsert(Trigger.newMap);
    if (Trigger.isUpdate)   handler.afterUpdate(Trigger.newMap, Trigger.oldMap);
    if (Trigger.isDelete)   handler.afterDelete(Trigger.oldMap);
    if (Trigger.isUndelete) handler.afterUndelete(Trigger.newMap);
  }
}</code></pre>

    <h2 id="handler">The Handler Pattern</h2>
    <p>The handler class is where the work happens. Each trigger context gets its own method. Business logic is delegated to service classes. The handler only orchestrates:</p>

<pre><code>public class AccountTriggerHandler {

  public void beforeInsert(List&lt;Account&gt; newAccounts) {
    AccountService.setDefaultRating(newAccounts);
    AccountService.validateNames(newAccounts);
  }

  public void afterInsert(Map&lt;Id, Account&gt; newAccountMap) {
    AccountService.createDefaultContacts(newAccountMap);
    AccountService.notifyAccountTeam(newAccountMap.keySet());
  }

  public void beforeUpdate(
    List&lt;Account&gt; newAccounts,
    Map&lt;Id, Account&gt; oldAccountMap
  ) {
    AccountService.preventCriticalFieldChange(newAccounts, oldAccountMap);
  }
}</code></pre>

    <div class="callout tip">
      <div class="callout-label">Tip</div>
      <p>Keep service methods static and accepting collections. <code>AccountService.setDefaultRating(List&lt;Account&gt;)</code> — never a single record. This forces bulkification at the service layer, where it belongs.</p>
    </div>

    <h2 id="bulkify">Bulkification in Practice</h2>
    <p>Here's the most common mistake I see — code that looks bulkified but isn't:</p>

<pre><code>// ❌ WRONG — SOQL inside a loop
public void afterInsert(Map&lt;Id, Account&gt; newMap) {
  for (Account acc : newMap.values()) {
    // Fires a SOQL query for EVERY account — hits limits fast
    List&lt;Contact&gt; contacts = [SELECT Id FROM Contact WHERE AccountId = :acc.Id];
  }
}

// ✅ CORRECT — Single SOQL, Map lookup in loop
public void afterInsert(Map&lt;Id, Account&gt; newMap) {
  Map&lt;Id, List&lt;Contact&gt;&gt; contactsByAccountId = new Map&lt;Id, List&lt;Contact&gt;&gt;();

  for (Contact c : [SELECT Id, AccountId FROM Contact
                    WHERE AccountId IN :newMap.keySet()]) {
    if (!contactsByAccountId.containsKey(c.AccountId)) {
      contactsByAccountId.put(c.AccountId, new List&lt;Contact&gt;());
    }
    contactsByAccountId.get(c.AccountId).add(c);
  }

  for (Id accountId : newMap.keySet()) {
    List&lt;Contact&gt; contacts = contactsByAccountId.get(accountId);
    if (contacts != null) { /* process */ }
  }
}</code></pre>

    <h2 id="testing">Testing for 200 Records</h2>
    <p>Your test class must prove the trigger works at bulk scale. A test that inserts one record proves almost nothing:</p>

<pre><code>@isTest
private class AccountTriggerHandlerTest {

  @isTest
  static void testBeforeInsert_Bulk() {
    List&lt;Account&gt; accounts = new List&lt;Account&gt;();
    for (Integer i = 0; i &lt; 200; i++) {
      accounts.add(new Account(Name = 'Test Account ' + i, Industry = 'Technology'));
    }

    Test.startTest();
    insert accounts;
    Test.stopTest();

    List&lt;Account&gt; inserted = [SELECT Id, Rating FROM Account WHERE Name LIKE 'Test Account%'];
    System.assertEquals(200, inserted.size(), 'All 200 accounts should be inserted');
    for (Account acc : inserted) {
      System.assertNotEquals(null, acc.Rating, 'Rating should be set by trigger');
    }
  }
}</code></pre>

    <h2 id="checklist">Production-Ready Checklist</h2>
    <ul>
      <li>✓ One trigger file per object — no business logic inside it</li>
      <li>✓ Handler class methods accept collections (<code>List&lt;SObject&gt;</code> or <code>Map&lt;Id, SObject&gt;</code>)</li>
      <li>✓ Zero SOQL queries inside any loop</li>
      <li>✓ Zero DML statements inside any loop</li>
      <li>✓ Test class uses 200 records minimum</li>
      <li>✓ Test class has meaningful <code>System.assert</code> calls — not just coverage</li>
      <li>✓ Trigger can be disabled via custom metadata for emergency bypass</li>
      <li>✓ No hard-coded IDs anywhere</li>
    </ul>
    <hr />
    <p>Triggers written this way won't just pass code review — they'll still work correctly two years from now when someone runs a bulk data migration touching every Account in the org. That's the real test.</p>
  </div>
</article>

<nav class="post-nav">
  <a href="article.html" class="post-nav-item prev"><div class="post-nav-dir">← Previous</div><div class="post-nav-title">Flow Builder: The 8 Mistakes Every Admin Makes</div></a>
  <a href="article.html" class="post-nav-item next"><div class="post-nav-dir">Next →</div><div class="post-nav-title">Writing Apex Tests That Actually Mean Something</div></a>
</nav>

<div style="background:var(--bg-card);border-top:1px solid var(--border);padding:3rem 0;">
  <div class="container-narrow">
    <div class="section-header"><div><span class="section-kicker">Keep reading</span><h2>Related Articles</h2></div><a href="category.html" class="section-link">View all</a></div>
    <div class="grid-2">
      <article class="article-card card-apex"><div class="article-card-body"><div class="article-card-tags"><a href="category.html" class="tag tag-navy">Apex</a></div><h3><a href="article.html">Governor Limits: A Field Guide to Every Limit That Matters</a></h3><p class="excerpt">Deep coverage of every governor limit that can affect your Apex code in production, with real mitigation strategies.</p><div class="article-card-meta"><span class="meta-author">Nilesh Dethe</span><span class="meta-date">Feb 3, 2026</span><span class="meta-read">22 min</span></div></div></article>
      <article class="article-card card-apex"><div class="article-card-body"><div class="article-card-tags"><a href="category.html" class="tag tag-navy">Apex</a><a href="category.html" class="tag tag-blue">Testing</a></div><h3><a href="article.html">Writing Apex Tests That Actually Mean Something</a></h3><p class="excerpt">Coverage is a metric, not a goal. Write tests that catch real bugs and keep your org deployment-ready.</p><div class="article-card-meta"><span class="meta-author">Nilesh Dethe</span><span class="meta-date">Feb 16, 2026</span><span class="meta-read">9 min</span></div></div></article>
    </div>
  </div>
</div>

<footer class="site-footer"><div class="container">
  <div class="footer-grid">
    <div class="footer-brand"><a href="../index.html" class="footer-logo"><img src="../logo-cloudforce.svg" alt="Cloudforce" class="footer-logo-image" /></a><p>Professional learning for Salesforce Admins, Developers &amp; Architects. Independent. Practitioner-written. Free.</p></div>
    <div class="footer-col"><h4>Topics</h4><ul class="footer-links"><li><a href="category.html">Salesforce Admin</a></li><li><a href="category.html">Apex Development</a></li><li><a href="category.html">Lightning Web Components</a></li><li><a href="category.html">Flow &amp; Automation</a></li><li><a href="category.html">Agentforce &amp; AI</a></li></ul></div>
    <div class="footer-col"><h4>Resources</h4><ul class="footer-links"><li><a href="category.html">Certification Guides</a></li><li><a href="category.html">Deep Dives</a></li><li><a href="category.html">Spring '26 Coverage</a></li></ul></div>
    <div class="footer-col"><h4>Site</h4><ul class="footer-links"><li><a href="about.html">About Cloudforce</a></li><li><a href="about.html">Write for Us</a></li><li><a href="#">RSS Feed</a></li></ul></div>
  </div>
  <div class="footer-bottom"><p class="footer-copy">© 2026 Cloudforce. Independent Salesforce blog. Not affiliated with Salesforce, Inc.</p><div class="footer-legal"><a href="#">Privacy</a><a href="#">Terms</a><a href="#">Sitemap</a></div></div>
</div></footer>
<script src="../js/main.js"></script>
</body></html>
